<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title><%= full_title(yield(:title)) %></title>
	
	<meta name="description" content="">

	<meta name="viewport" content="width=device-width">
<!-- 	<link rel="stylesheet" href="style/styleh5bp.css"> -->



	<%= stylesheet_link_tag    "application", media: "all" %>
	<%= javascript_include_tag "application" %>
	<%= csrf_meta_tags %>
</head>

<body>

	<!-- ///////////////////////////////////ACCOUNT////////////////////////////////////////// -->
	<%= render 'layouts/account' %>

	<!-- ///////////////////////////////////FLASH////////////////////////////////////////// -->
	<div class ="flash">
		<% flash.each do |key, value| %>
			<!--<button class="close" data-dismiss="alert">×</button>	-->

			<%= content_tag(:div, value, class: "alert alert-#{key}") %>
		<% end %>
	</div>
	<!-- ///////////////////////////////////SIDEBAR1//////////////////////////////////////////-->
	<div class="sidebar sidebar1" >
		
		<div id="home" class="head">
			<%= image_tag 'img/head-logo.png', alt: "One Spark Logo" %>
		</div>
		
		<div id="projectHead" class="head">
			<h3><%= @project.title %></h3>
		</div>
		

		<div class="scroll-pane jspScrollable tools">
			
			<%= link_to '' do %>
				<div class="tool add" >Add tool</div>
			<% end %>
			
			<%= link_to project_path(@project) do %>
				<div class="tool overview" >Overview</div>
			<% end %>
			
			<%= link_to project_coworkers_path(@project) do %>
				<div class="tool coworkers" >Coworkers</div>
			<% end %>

			<%= link_to content_tag('div', 'DropBox', class: 'tool files'), project_dropbox_path(@project),  'data-disable-with' => '<div class ="tool active files ">loading...</div>' %>
			
			<%= link_to project_milestones_path(@project) do %>
				<% if yield(:active) == 'milestones' %>
					<div class="tool milestones active" >Tasks</div>
				<% else %>
					<div class="tool milestones" >Tasks</div>
				<% end %>
			<% end %>		

			<%= link_to project_github_path(@project) do %>
				<div class="tool milestones" >GitHub</div>
			<% end%>

			<%= link_to '' do %>
				<div class="tool documents" >Documents</div>
			<% end%>
			
			<%= link_to '' do %>
				<div class="tool calendar" >Appointments</div>
			<% end%>

			<%= link_to project_topics_path(@project) do %>
			<div class="tool dialogs" >Topics</div>
			<% end%>

			<%= link_to '' do %>
				<div class="tool settings" >Settings</div>
			<% end%>

			<%= link_to '' do %>
				<div class="tool trash" >Trash</div>
			<% end%>
		</div>
	</div>


	<!-- ///////////////////////////////////CONTENT//////////////////////////////////////////-->

	<%= yield %>

	<!-- ///////////////////////////////////Debug//////////////////////////////////////////-->
<div class= "debug">
	<% if Rails.env.development? %>
		<%= debug(params) %>
		<%= debug(current_user) if current_user %>
	<% end %>
</div>

<script type="text/javascript">

var scroll = $('.scroll-pane');
var content = $('.content');

var headHeight = $('.head').height();
var sidebarWidth = ($('.sidebar').width())*2 + 1;

console.log("Breite der Tools/ Folder: " + sidebarWidth);
// console.log("Größe Header = "+headHeight);
// console.log("Größe Footer = "+bottomHeight);

var toolheight = function(){
	var height = (($(window).height()) - headHeight).toString();
	console.log("toolHeight: "+height);
	scroll.css("height", height + "px");
};
var contentWidth = function(){
	var width = (($(window).width()) - sidebarWidth).toString();
	console.log("contentWidth: "+width + "windowWidth: "+ $(window).width().toString());
	content.css("width", width + "px");
	content.css("float", "left");
};

var headerSpacing = function(selector){
	var s1 = $(selector);
	var s1margin = (0 - s1.height() / 2 + 2).toString();
	console.log(s1margin);
	s1.css('margin-top',s1margin+'px');
}

 $(window).ready(
 	toolheight(), 
 	contentWidth(), 
 	headerSpacing('#projectHead h3'), 
 	headerSpacing('#toolHead h3'),
 	headerSpacing('#contentHead h3')
 );


$(window).resize(function(){
	toolheight();
});
// $(window).resize(function(){
// 	contentWidth();
// });



// Scrollbar-Replacement
$(function()
{
	$('.scroll-pane').each(
		function()
		{
			$(this).jScrollPane(
				{	
					showArrows: $(this).is('.arrow')
				}
			);
			var api = $(this).data('jsp');
			var throttleTimeout;
			$(window).bind(
				'resize',
				function()
				{
					if ($.browser.msie) {
						// IE fires multiple resize events while you are dragging the browser window which
						// causes it to crash if you try to update the scrollpane on every one. So we need
						// to throttle it to fire a maximum of once every 50 milliseconds...
						if (!throttleTimeout) {
							throttleTimeout = setTimeout(
								function()
								{
									api.reinitialise();
									throttleTimeout = null;
								},
								50
							);
						}
					} else { 
						api.reinitialise();
					}
				}
			);
		}
	)

});
$(function()
{
	$('.scroll-pane').jScrollPane(
		{
			hijackInternalLinks: true,
			animateScroll: false
		}
	);
});
</script>
</body>
</html>